# MemoryHunter ğŸ“¸

<div align="center">

**åŸºäº AI çš„æœ¬åœ°ç›¸å†Œè¯­ä¹‰æœç´¢ç³»ç»Ÿ**

è®©ä½ ç”¨ä¸­æ–‡è‡ªç„¶è¯­è¨€å¿«é€Ÿæ‰¾åˆ°ç›¸å†Œä¸­çš„ä»»ä½•ç…§ç‰‡

[![Docker](https://img.shields.io/badge/Docker-Ready-2496ED?logo=docker&logoColor=white)](https://www.docker.com/)
[![Python](https://img.shields.io/badge/Python-3.10-3776AB?logo=python&logoColor=white)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.104-009688?logo=fastapi&logoColor=white)](https://fastapi.tiangolo.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

</div>

---

## âœ¨ ç‰¹æ€§

- ğŸ” **ä¸­æ–‡è¯­ä¹‰æœç´¢** - è¾“å…¥"è“è‰²çš„è£™å­"ã€"å¤•é˜³æµ·æ»©"ã€"é‚£åªæ©˜çŒ«"ç­‰è‡ªç„¶æè¿°ï¼Œç²¾å‡†æ‰¾åˆ°ç›¸å…³ç…§ç‰‡
- ğŸ  **100% æœ¬åœ°è¿è¡Œ** - æ‰€æœ‰æ•°æ®å’Œæ¨¡å‹éƒ½åœ¨æœ¬åœ°ï¼Œéšç§å®‰å…¨æœ‰ä¿éšœ
- ğŸš€ **ä¸€é”®éƒ¨ç½²** - Docker å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ— éœ€å¤æ‚é…ç½®
- ğŸ¨ **ç°ä»£åŒ– UI** - æ·±è‰²ä¸»é¢˜ï¼Œæµç•…åŠ¨ç”»ï¼Œå“åº”å¼è®¾è®¡
- ğŸ¤– **Chinese-CLIP æ¨¡å‹** - ä¸“ä¸ºä¸­æ–‡ä¼˜åŒ–çš„å¤šæ¨¡æ€ AI æ¨¡å‹
- ğŸ’¾ **ChromaDB å‘é‡å­˜å‚¨** - é«˜æ•ˆçš„å‘é‡æ£€ç´¢ï¼Œæ¯«ç§’çº§æœç´¢å“åº”
- ğŸ“ **å¤šæ ¼å¼æ”¯æŒ** - JPG, PNG, WEBP, HEIC (macOS ç›¸å†Œæ ¼å¼)

---

## ğŸ¯ åº”ç”¨åœºæ™¯

```
ğŸ“¸ "å»å¹´å¤å¤©æµ·è¾¹é‚£å¼ ç…§ç‰‡" â†’ æ‰¾åˆ°æ‰€æœ‰æµ·æ»©ç…§ç‰‡
ğŸ± "é‚£åªæ©˜è‰²çš„çŒ«" â†’ æ‰¾åˆ°å® ç‰©ç…§ç‰‡
ğŸ• "æŠ«è¨" â†’ æ‰¾åˆ°ç¾é£Ÿç…§ç‰‡
ğŸ‘— "è“è‰²è¿è¡£è£™" â†’ æ‰¾åˆ°æœé¥°ç…§ç‰‡
ğŸŒ… "æ—¥è½" â†’ æ‰¾åˆ°å¤•é˜³ç…§ç‰‡
```

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Web UI (HTML/CSS/JS)          â”‚  â† ç”¨æˆ·ç•Œé¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI Backend               â”‚  â† ä¸šåŠ¡é€»è¾‘
â”‚   â€¢ ç´¢å¼•ç®¡ç†                     â”‚
â”‚   â€¢ æœç´¢å¼•æ“                     â”‚
â”‚   â€¢ çŠ¶æ€ç›‘æ§                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Chinese â”‚   â”‚  ChromaDB  â”‚  â† æ•°æ®å±‚
â”‚  CLIP  â”‚   â”‚ (å‘é‡æ•°æ®åº“)â”‚
â”‚ (CPU)  â”‚   â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶:**
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS/JavaScript (æ— ä¾èµ–)
- **åç«¯**: FastAPI + Uvicorn
- **AI æ¨¡å‹**: Chinese-CLIP ViT-Base (OFA-Sys)
- **å‘é‡åº“**: ChromaDB (æŒä¹…åŒ–å­˜å‚¨)
- **éƒ¨ç½²**: Docker + Docker Compose

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Docker Desktop (æ¨èæœ€æ–°ç‰ˆæœ¬)
- macOS / Linux / Windows
- è‡³å°‘ 4GB å¯ç”¨å†…å­˜
- è‡³å°‘ 2GB å¯ç”¨ç£ç›˜ç©ºé—´

### 1ï¸âƒ£ æ„å»º Docker é•œåƒ

```bash
# å…‹éš†æˆ–è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/wangyouwei/Projects/vector_photo

# æ„å»º Docker é•œåƒ (çº¦ 3-5 åˆ†é’Ÿ)
docker build -t memory-hunter:latest .
```

### 2ï¸âƒ£ è¿è¡Œå®¹å™¨

```bash
# è¿è¡Œ MemoryHunter
docker run -d \
  --name memory-hunter \
  -p 8000:8000 \
  -v ~/Pictures/TestDataset:/app/photos:ro \
  -v ~/memory-hunter-data:/app/chroma_db \
  memory-hunter:latest
```

**å‚æ•°è¯´æ˜:**
- `-d`: åå°è¿è¡Œ
- `-p 8000:8000`: æ˜ å°„ç«¯å£ (è®¿é—® http://localhost:8000)
- `-v ~/Pictures/TestDataset:/app/photos:ro`: æŒ‚è½½ç›¸å†Œç›®å½• (**åªè¯»æ¨¡å¼**)
- `-v ~/memory-hunter-data:/app/chroma_db`: æŒä¹…åŒ–å‘é‡æ•°æ®åº“

> ğŸ’¡ **æç¤º**: è¯·å°† `~/Pictures/TestDataset` æ›¿æ¢ä¸ºä½ çš„å®é™…ç›¸å†Œè·¯å¾„

### 3ï¸âƒ£ è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®: **http://localhost:8000**

### 4ï¸âƒ£ å¼€å§‹ä½¿ç”¨

1. **ç´¢å¼•å›¾ç‰‡**: ç‚¹å‡» "ğŸ”„ å¼€å§‹ç´¢å¼•" æŒ‰é’®
2. **ç­‰å¾…å®Œæˆ**: 100å¼ å›¾ç‰‡çº¦éœ€ 5-10 åˆ†é’Ÿ (CPU æ¨¡å¼)
3. **å¼€å§‹æœç´¢**: è¾“å…¥ä¸­æ–‡æè¿°ï¼Œä¾‹å¦‚ "è“è‰²çš„å¤©ç©º"
4. **æŸ¥çœ‹ç»“æœ**: ç‚¹å‡»å›¾ç‰‡å¯å…¨å±æŸ¥çœ‹

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç´¢å¼•ç®¡ç†

**é¦–æ¬¡ä½¿ç”¨:**
```
1. ç‚¹å‡» "å¼€å§‹ç´¢å¼•" â†’ ç³»ç»Ÿæ‰«æç›¸å†Œç›®å½•
2. è¿›åº¦æ¡æ˜¾ç¤ºç´¢å¼•è¿›åº¦
3. ç´¢å¼•å®Œæˆåè‡ªåŠ¨ä¿å­˜åˆ° ChromaDB
```

**å¢é‡ç´¢å¼•:**
```
- æ·»åŠ æ–°ç…§ç‰‡åå†æ¬¡ç‚¹å‡» "å¼€å§‹ç´¢å¼•"
- ç³»ç»Ÿä¼šè·³è¿‡å·²ç´¢å¼•çš„å›¾ç‰‡
- åªå¤„ç†æ–°å¢çš„ç…§ç‰‡
```

### æœç´¢æŠ€å·§

**åŸºç¡€æœç´¢:**
```
âœ… "è“è‰²çš„å¤©ç©º"
âœ… "çŒ«å’ª"
âœ… "ç¾é£Ÿ"
âœ… "å±±"
```

**é«˜çº§æœç´¢:**
```
ğŸ“Š è¿”å›æ•°é‡: æ§åˆ¶è¿”å›ç»“æœæ•° (1-50)
ğŸ¯ ç›¸ä¼¼åº¦é˜ˆå€¼: è¿‡æ»¤ä½ç›¸ä¼¼åº¦ç»“æœ (0.0-1.0)
   - 0.0: è¿”å›æ‰€æœ‰ç»“æœ
   - 0.3: è¾ƒå®½æ¾çš„è¿‡æ»¤
   - 0.5: ä¸­ç­‰è¿‡æ»¤
   - 0.7: ä¸¥æ ¼è¿‡æ»¤
```

### æ€§èƒ½ä¼˜åŒ–

**æ•°æ®è§„æ¨¡å»ºè®®:**
- âœ… 100-500 å¼ : æµç•…ä½“éªŒ
- âš ï¸ 500-1000 å¼ : é¦–æ¬¡ç´¢å¼•è¾ƒæ…¢ï¼Œæœç´¢å¿«é€Ÿ
- âŒ 1000+ å¼ : å»ºè®®å‡çº§åˆ° GPU ç‰ˆæœ¬

**åŠ é€Ÿç´¢å¼•:**
```bash
# å¦‚æœä½ æœ‰ GPU (éœ€ä¿®æ”¹ config.py)
DEVICE = "cuda"  # æ›¿æ¢ "cpu"
```

---

## ğŸ› ï¸ Docker å‘½ä»¤

### æŸ¥çœ‹æ—¥å¿—
```bash
docker logs memory-hunter
```

### åœæ­¢å®¹å™¨
```bash
docker stop memory-hunter
```

### é‡å¯å®¹å™¨
```bash
docker restart memory-hunter
```

### åˆ é™¤å®¹å™¨
```bash
docker stop memory-hunter
docker rm memory-hunter
```

### æ¸…ç†æ•°æ®åº“
```bash
# åˆ é™¤å‘é‡æ•°æ®åº“ç›®å½•
rm -rf ~/memory-hunter-data
```

---

## ğŸ”§ API æ–‡æ¡£

### ç´¢å¼• API

**è§¦å‘ç´¢å¼•**
```bash
curl -X POST http://localhost:8000/api/index
```

**æŸ¥çœ‹ç´¢å¼•çŠ¶æ€**
```bash
curl http://localhost:8000/api/index/status
```

### æœç´¢ API

**æœç´¢å›¾ç‰‡**
```bash
curl -X POST http://localhost:8000/api/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "è“è‰²çš„å¤©ç©º",
    "top_k": 20,
    "threshold": 0.0
  }'
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "query": "è“è‰²çš„å¤©ç©º",
  "results": [
    {
      "path": "/app/photos/IMG_001.jpg",
      "filename": "IMG_001.jpg",
      "score": 0.8732
    }
  ],
  "count": 1
}
```

### ç»Ÿè®¡ API

```bash
curl http://localhost:8000/api/stats
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
memory-hunter/
â”œâ”€â”€ backend/                 # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ main.py             # FastAPI åº”ç”¨
â”‚   â”œâ”€â”€ config.py           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ models.py           # Chinese-CLIP æ¨¡å‹
â”‚   â”œâ”€â”€ database.py         # ChromaDB å°è£…
â”‚   â”œâ”€â”€ indexer.py          # ç´¢å¼•å™¨
â”‚   â””â”€â”€ searcher.py         # æœç´¢å¼•æ“
â”œâ”€â”€ frontend/               # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ index.html          # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ style.css           # æ ·å¼
â”‚   â””â”€â”€ app.js              # äº¤äº’é€»è¾‘
â”œâ”€â”€ Dockerfile              # Docker é…ç½®
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â”œâ”€â”€ .dockerignore          # Docker å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md              # æœ¬æ–‡æ¡£
```

---

## â“ å¸¸è§é—®é¢˜

### Q: HEIC æ ¼å¼å›¾ç‰‡ä¸æ˜¾ç¤º?
A: ç¡®ä¿å·²å®‰è£… `libheif-dev`ï¼ŒDockerfile å·²åŒ…å«æ­¤ä¾èµ–ã€‚

### Q: ç´¢å¼•é€Ÿåº¦å¤ªæ…¢?
A: CPU æ¨¡å¼ä¸‹æ­£å¸¸ç°è±¡ï¼Œ100å¼ å›¾ç‰‡çº¦ 5-10 åˆ†é’Ÿã€‚å¯è€ƒè™‘:
- å‡å°‘å›¾ç‰‡æ•°é‡
- ä½¿ç”¨ GPU åŠ é€Ÿ (éœ€ä¿®æ”¹é…ç½®)

### Q: æœç´¢ç»“æœä¸å‡†ç¡®?
A: å°è¯•:
- é™ä½ç›¸ä¼¼åº¦é˜ˆå€¼
- ä½¿ç”¨æ›´å…·ä½“çš„æè¿°è¯
- é‡æ–°ç´¢å¼•å›¾ç‰‡

### Q: ç«¯å£ 8000 è¢«å ç”¨?
A: ä¿®æ”¹ç«¯å£æ˜ å°„:
```bash
docker run -d -p 8080:8000 ...  # ä½¿ç”¨ 8080 ç«¯å£
```

### Q: å¦‚ä½•æ›´æ–°ç›¸å†Œ?
A: æ·»åŠ æ–°ç…§ç‰‡å,å†æ¬¡ç‚¹å‡» "å¼€å§‹ç´¢å¼•" å³å¯ã€‚

---

## ğŸ” éšç§ä¸å®‰å…¨

- âœ… **100% æœ¬åœ°è¿è¡Œ** - æ•°æ®ä¸ä¸Šä¼ ä»»ä½•æœåŠ¡å™¨
- âœ… **åªè¯»æŒ‚è½½** - å®¹å™¨æ— æ³•ä¿®æ”¹åŸå§‹ç…§ç‰‡
- âœ… **å¼€æºé€æ˜** - æ‰€æœ‰ä»£ç å¯å®¡æŸ¥

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

**æµ‹è¯•ç¯å¢ƒ:** macOS 13 (x86_64), Docker Desktop, 8GB RAM

| æ“ä½œ | 100å¼ å›¾ç‰‡ | 500å¼ å›¾ç‰‡ | 1000å¼ å›¾ç‰‡ |
|------|----------|----------|-----------|
| ç´¢å¼•æ—¶é—´ | ~8 åˆ†é’Ÿ | ~40 åˆ†é’Ÿ | ~80 åˆ†é’Ÿ |
| æœç´¢å»¶è¿Ÿ | <100ms | <150ms | <200ms |
| å†…å­˜å ç”¨ | ~2GB | ~2.5GB | ~3GB |

---

## ğŸ—ºï¸ æœªæ¥è§„åˆ’

- [ ] GPU åŠ é€Ÿæ”¯æŒ
- [ ] å›¾ç‰‡å»é‡åŠŸèƒ½
- [ ] æ™ºèƒ½ç›¸å†Œåˆ†ç±»
- [ ] ä»¥å›¾æœå›¾åŠŸèƒ½
- [ ] å¤šç”¨æˆ·æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯é€‚é…

---

## ğŸ“„ å¼€æºè®¸å¯

MIT License - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

- [Chinese-CLIP](https://github.com/OFA-Sys/Chinese-CLIP) - å¤šæ¨¡æ€é¢„è®­ç»ƒæ¨¡å‹
- [ChromaDB](https://www.trychroma.com/) - å‘é‡æ•°æ®åº“
- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£ Web æ¡†æ¶

---

<div align="center">

**Made with â¤ï¸ for Privacy-First Photo Search**

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æ Issue!

</div>
